import json
import codecs

print("Matching [Name] and [English]... from data.json and translations.json")
count=0
length=0
outputDictionary = {}
ignore = ["Changelog","READ ME","Variants","Patterns","HHA Themes","HHA Set","HHA Situation","Special NPCs","Villagers Catch Phrase"]
with open('data.json', encoding='utf-8-sig') as d:
    data = json.load(d)
with open('translations.json', encoding='utf-8-sig') as t:
    translation = json.load(t)

sourceNotes = [None, "Available in Nook's Cranny (either upgrade tier) in the unique furniture slot", "Available in Nook's Cranny (upgraded only), in the unique furniture slot", "Available in Nook's Cranny (upgraded only), in the third unique furniture slot", 'Available in all tiers of shops, including Timmy & Tommy before the shop is opened', 'Link Nintendo Account to Pocket Camp, then redeem a 16-digit code on your Nintendo Switch', 'Scan the associated Sanrio amiibo card', 'Reward from Pavé after receiving 9 furniture items and giving 3 rainbow feathers', 'Trade 3 insects to receive a model in the mail the next day', "Available in Nook's Cranny (upgraded only), in the seasonal slot", 'Mailed to the player from Luna', 'Trade 3 fish to receive a model in the mail the next day', "Available in the re-buyable slot in Nook's Cranny", 'Mailed to players using the limited edition ACNH Nintendo Switch after the 1.1.0 update in a letter from Nintendo', 'Mailed to players once ordered from NookLink within the Nintendo Switch Online app', 'From Zipper after trading one of every egg (all 6 types)', 'Reward for finishing all recipes', 'Received in mail from DAL after 300 flights', 'Received in mail from DAL after 50 flights', 'Mailed to players after the 1.9.0 update in a letter from Nook Inc.', 'Received in March in the Northern Hemisphere and received in September in the Southern Hemisphere', 'Received in September in the Northern Hemisphere and received in March in the Southern Hemisphere', "Received on the player's birthday", 'Received in August in the Northern Hemisphere and received in July in the Southern Hemisphere', 'Received in July in the Northern Hemisphere and received in February in the Southern Hemisphere', 'Received in October in the Northern Hemisphere and received in April in the Southern Hemisphere', 'Received in April in the Northern Hemisphere and received in October in the Southern Hemisphere', 'Mailed to players after the 1.1.0 update in a letter from Nintendo', 'Mailed to players after the 1.5.0 update in a letter from Nintendo', 'Reward for solving May Day maze', 'Reward for gifting candy on Halloween', 'Mailed to players after the 1.6.0 update in a letter from Nintendo', 'Reward for completing the Stamp Rally in the bug exhibit during International Museum Day', 'Reward for completing the Stamp Rally in the fish gallery during International Museum Day', 'Reward for completing the Stamp Rally in the fossil gallery during International Museum Day', 'Received in the mail', 'Received in January in both Hemipsheres', 'Received in February in the Northern Hemisphere and received in August in the Southern Hemisphere', 'Trade candy or a lollipop with a villager', 'Mailed to players after the 1.2.0 update in a letter from Nintendo', 'Mailed to players after the 1.4.0 update in a letter from Nintendo', 'Mailed to players after the 1.8.0 update in a letter from Nintendo', 'Reward for giving Franklin the requested ingredients', 'Received in November in the Northern Hemisphere and received in May in the Southern Hemisphere', 'In the Special Items section in Nook Shopping, after inviting the villager to Photopia (either through amiibo, or if the villager lives in your town)', 'In the Special Items section in Nook Shopping, after inviting to Photopia with an amiibo ', "Available from Redd's Raffle during Fireworks Shows; Available from Nook's Cranny rotating cabinet stock outside of August", "Available in Nook's Cranny (upgraded only)", 'Available after unlocking the axe in the story', 'Available after unlocking the shovel in the story', "Obtained by speaking to Isabelle on New Year's Eve", 'Mailed to players after the 1.7.0 update in a letter from Nintendo', "Available from Nook's Cranny; \r\nAvailable from Tom Nook during Countdown", '50 fences are given by Tom Nook after completing the three house plots during the main storyline', 'Available from Able Sisters shop only', "Available from either Mabel's temporary shop or Able Sisters shop", 'Received in mail from DAL after 100 flights', 'Received in mail from DAL after 250 flights', 'Received in mail from DAL after 5 flights', 'Added to Able Sisters stock rotation the day after receiving this item from Label', 'Received in December in the Northern Hemisphere and received in June in the Southern Hemisphere', 'Received in June in the Northern Hemisphere and received in December in the Southern Hemisphere', 'Give Jack candy or a lollipop', 'Received in mail from DAL after 130 flights', 'Received in mail from DAL after 15 flights', 'Received in mail from DAL after 75 flights', "Mailed to players after the 1.3.0 update in a letter from Nintendo; Available from either Mabel's temporary shop or Able Sisters shop", 'Received in mail from DAL after 30 flights', 'Available at Able Sisters only during Fireworks Shows', 'Received in mail from DAL after 200 flights', 'Received in May in the Northern Hemisphere and received in November in the Southern Hemisphere', 'Received in mail from DAL after 160 flights', 'Possible song K.K. will play when choosing "It\'s hard to say." as your mood', 'Possible song K.K. will play when choosing "Laid-back." as your mood', 'Hidden song - only by request', 'Possible song K.K. will play when choosing "I feel good!" as your mood', 'Possible song K.K. will play when choosing "A little blue..." as your mood', 'Possible song K.K. will play when choosing "A little grumpy..." as your mood', 'Received on your first time seeing K.K. perform during your birthday', 'Received on your first time seeing K.K. perform', "Played by K.K. if you request something he doesn't have (does not give take-home track)", 'Shaking', 'Found under the Special tab of the Nook Miles Redemption service.', 'Near a bamboo tree', 'Shaking decorated trees', 'Medium shadow', "Sold in Nook's Cranny during the month of October; gifted by talking to villagers during Halloween", 'Only available while on a quest for Gullivarrr', 'Only available while on a quest for Gulliver', "Obtained from Franklin after completing 4 recipes with secret ingredient; sold in Nook's Cranny after Turkey Day until the end of November", "Received in the mail the day after uploading your island to Luna's Dream Library", 'Small shadow', 'Black roses watered with gold watering can', 'Reward for helping Cyrus & Reese during Wedding Season', 'Reward for making a perfect Snowboy', 'Large shadow', 'Obtained from crafting villagers during October if player already knows the recipe or as a reward for gifting candy on Halloween', 'Since 1.6.0, Leif sells pumpkin starts year-round.', 'Near cedar and hardwood trees', 'X-Small shadow when fishing', "Placed randomly on island for a villager's treasure hunt quest", 'Only available on Sundays; buy value ranges from 90-110 per turnip but can only be bought in stacks of 10 or more; sell value ranges from 9-660 depending on the current market price', 'Only available while on a quest for Wisp', 'Obtained during the main storyline during the villager house development quest if the native fruit is apples', 'Purchase Pretty Good Tools Recipes via Nook Miles Redemption', '50% chance of being obtained during the main storyline during the villager house development quest', "Purchase Wildest Dreams DIY from Nook's Cranny", 'Obtained during the main storyline', 'Reward from Zipper after collecting all 6 egg types', 'Reward from Zipper after crafting wobbling Zipper toy', 'Obtained from Tom Nook after completing his DIY Workshop at the beginning of the game', 'Obtained during the main storyline during the villager house development quest if the native fruit is cherries', 'Obtained during the main storyline during the villager house development quest', 'Obtained during the main storyline during the villager house development quest if the native flower is cosmos', "Obtained through Tom Nook's DIY Workshop at the beginning of the game and can also be purchased at Nook's Cranny", "Obtained through Tom Nook's DIY Workshop at the beginning of the game", "Purchase DIY for Beginners at Nook's Cranny", 'Fish up 15 trash', 'Reward from Jingle after delivering more than half the gifts on Toy Day', 'Balloon appears after shooting 300 balloons', 'Obtained after the 5-star island evaluation', 'Obtained from Tom Nook after completing one Nature Day Nook Miles+ task; Obtained from Leif after buying anything from him on three different days', 'Obtained during the main storyline during the villager house development quest if the native flower is hyacinths', 'Picking up gold nuggets knocked out of rocks', 'Obtained during the main storyline during the villager house development quest if the native flower is lilies', "Purchase Test Your DIY Skills from Nook's Cranny", 'Obtained during the main storyline during the villager house development quest if the native flower is mums', 'Obtained during the main storyline during the villager house development quest if the native fruit is oranges', 'Obtained during the main storyline during the villager house development quest if the native flower is pansies', 'Obtained during the main storyline during the villager house development quest if the native fruit is peaches', 'Obtained during the main storyline during the villager house development quest if the native fruit is pears', 'Also obtained from digging up an existing pitfall', 'Talk to Pavé during the Festivale event', 'Fish up 1 boot', 'Fish up 3 empty cans', 'Obtained during the main storyline during the villager house development quest if the native flower is roses', 'Obtained from crafting villagers during October or as a reward for gifting candy on Halloween', 'Reward for gifting lollipop on Halloween', 'Fish up 1 empty can', "Purchase Test Your DIY Skills from Nook's Cranny; 50% chance of being obtained during the main storyline during the villager house development quest", 'Fish up 3 old tires', 'Fish up 1 old tire', 'Obtained during the main storyline during the villager house development quest if the native flower is tulips', "Obtain Cozy Turkey Day DIY from Franklin or buy it from Nook's Cranny", 'Obtained during the main storyline during the villager house development quest if the native flower is windflowers', 'Reward from Zipper after crafting all Bunny Day recipes', 'Obtained during the main storyline during the customization workshop', "Purchase Test Your DIY Skills from Nook's Cranny; Obtained during the main storyline during the villager house development quest", 'Requires a high level of friendship']
sources = [None, 'Nook Shopping Promotion', 'Nook Shopping Seasonal', 'Crafting', "Nook's Cranny", 'C.J.', 'Flick', 'Birthday', 'Starting items', 'Nook Miles Redemption', 'Pavé', 'Luna', 'Gulliver', 'Gullivarrr', 'Jack', 'Jingle', 'Franklin', 'Cyrus', 'Nintendo', 'Nook Shopping Daily Selection', 'NookLink', 'HHA', 'Zipper', 'Dodo Airlines', 'Mom', 'Rover', 'All villagers', 'Blathers', 'Saharah', 'High Friendship', 'Check Toy Day stockings the day after Toy Day', 'Nook Shopping Posters', "Redd's Raffle", 'Wilbur', 'Isabelle', 'Tom Nook', 'May Day Tour', 'Able Sisters', 'Recycle box', 'Label', 'Pascal', 'Kicks', 'K.K. concert', 'Assessing fossils', "Jolly Redd's Treasure Trawler", 'Hardwood Tree', 'Apple Tree', 'Planting an apple', 'Wishing on shooting stars', 'Chopping a bamboo tree', 'Dig Spot', 'Daisy Mae', 'Planting a bamboo shoot', 'Glowing dig spot', 'Shaking a hardwood or cedar tree', 'Picking flowers', 'Breeding', 'Catching with a net', 'Cedar Tree', 'Digging up a fully grown bush', 'Leif', 'Fishing', 'Villagers', 'Planting a cedar sapling', 'Cherry Tree', 'Planting a cherry', 'Hitting a rock', 'On ground', 'Coconut Tree', 'Planting a coconut', 'Dive spot', 'Clam dig spot', 'Beach', 'Nook Shopping', 'Delivering item for a villager', 'Wrapping a present', 'Picking pumpkins', 'Chopping a tree', 'Planting a sapling', 'Reese', 'Snowboy', '5-star town status', 'Burying bells in a glowing spot', 'Orange Tree', 'Planting an orange', 'Seed bag', 'Peach Tree', 'Planting a peach', 'Pear Tree', 'Planting a pear', 'Mail', 'Digging up a pumpkin plant', 'Egg balloon', 'Expired turnips', 'Use a fountain firework', "Don't return lost item", "Don't return treasure quest item", 'Resident Services Upgrade', '4th House Upgrade (Right Room)', '3rd House Upgrade (Left Room)', 'Tent', 'Initial House', '5th House Upgrade (2nd Floor)', 'Balloons', 'Smug villagers', 'Lazy villagers', 'Big Sister villagers', 'Celeste', 'Cranky villagers', 'Snooty villagers', 'Pretty Good Tools Recipes', 'Peppy villagers', 'Normal villagers', 'Jock villagers', 'Wildest Dreams DIY', 'Egg bottle', 'Collecting earth eggs', 'Learning all egg outfit DIYs', 'Digging up clams', 'DIY for Beginners', 'Breaking 100 axes', 'Completing bug Critterpedia', 'Completing fish Critterpedia', 'Helping Gulliver 30 times', 'Gold balloon', 'Collecting leaf eggs', 'All villagers (while stung)', 'Test Your DIY Skills', 'Collecting sky eggs', 'Collecting stone eggs', 'Cozy Turkey Day DIY', 'Collecting water eggs', 'Harvey', 'Collecting wood eggs', 'Viva Festivale Reaction Set', 'Hip Reaction Collection']
missingItems = [None, 'Coral Nook Inc. aloha shirt', 'Green Nook Inc. aloha shirt', 'Hazure01', 'Hazure02', 'Hazure03', 'Bell bag', 'Bell coin', 'present (black)', 'present (blue)', 'present (brown)', 'present (chartreuse)', 'present (gold)', 'present (gray)', 'present (green)', 'present (light-blue)', 'present (mint)', 'present (navy)', 'present (orange)', 'present (pink)', 'present (purple)', 'present (red)', 'present (white)', 'present (yellow)', 'spoiled turnips', 'turnips', '(island name) Miles!', 'Angling for Perfection!', 'Island Ichthyologist', 'Island Togetherness', "You've Got the Bug", "Bugs Don't Bug Me", 'Have a Nice DIY!', 'Deep Dive', 'Underwater Understudy', 'DIY Tools', 'DIY Furniture', 'Furniture Freshener', 'Rough-hewn', 'Trashed Tools', 'Rock-Splitting Champ', 'Bona Fide Bone Finder!', 'Fossil Assessment', 'Greedy Weeder', 'Flower Power', 'Flower Tender', "Tomorrow's Trees Today", 'Pick of the Bunch', 'Fruit Roots', 'Shrubbery Hububbery', 'Go Ahead. Be Shellfish!', 'Clam and Collected', "Trash Fishin'", 'Cast Master', 'Dream House', 'Decorated Decorator', 'Hoard Reward', 'Good Things in Store!', 'Remarkable Remodeler', 'Smile Isle', 'Reaction Ruler', 'Island Shutterbug', 'Edit Credit', 'NookPhone Life', "That's One Smart Phone", 'Shop to It', 'Growing Collection', 'Nook Miles for Miles!', 'First-Time Buyer', 'Seller of Unwanted Stuff', 'Moving Fees Paid!', 'Bell Ringer', 'Miles for Stalkholders', 'Cornering the Stalk Market', 'No More Loan Payments!', 'Bulletin-Board Benefit', 'Popular Pen Pal', 'Flea Flicker', 'Cicada Memories', 'Netting Better!', 'Pit-y Party!', 'Taking the Sting Out', 'Faint of Heart', 'Overcoming Pitfalls', 'Faked Out!', 'Lost Treasure', "It's Raining Treasure!", 'Fun with Fences', 'Snowmaestro', 'Wishes Come True', 'Exterior Decorator', '(island name) Icons', 'Island Designer', 'Wispy Island Secrets', "Gulliver's Travails", 'K.K. Mania', 'True Patron of the Arts', 'You Otter Know', 'True Friends', 'Birthday Celebration', 'Happy Birthday!', 'Fishing Tourney!', 'Bug-Off!', 'Countdown Celebration', 'Making a Change', 'First Custom Design!', 'Custom Design Pro!', 'Paydirt!', 'Shady Shakedown', 'Golden Milestone', 'Island and Yourland', 'Host the Most', 'Active Island Resident', 'Blanca', 'Blathers', 'Booker', 'Brewster', 'C.J.', 'Celeste', 'Chip', 'Cyrus', 'Daisy Mae', 'Digby', 'DJ KK', 'Don', 'Flick', 'Franklin', 'Gracie', 'Grams', 'Gullivarrr', 'Gulliver', 'Harriet', 'Harvey', 'Isabelle', 'Jack', 'Jingle', 'Joan', 'K.K.', "Kapp'n", 'Katie', 'Katrina', 'Kicks', 'Label', 'Leif', 'Leila', 'Leilani', 'Lottie', 'Luna', 'Lyle', 'Mabel', 'Nat', 'Orville', 'Pascal', 'Pavé', 'Pelly', 'Pete', 'Phineas', 'Phyllis', 'Porter', 'Redd', 'Reese', 'Resetti', 'Rover', 'Sable', 'Saharah', 'Shrunk', 'Timmy', 'Tom Nook', 'Tommy', 'Tortimer', 'Wendell', 'Wilbur', 'Wisp', 'Zipper', 'Acorn card', 'Airmail card', 'Baby-goods card', 'Balloons card', 'Bandage card', 'Beach card', 'Birthday-cake card', 'Blue-sky card', 'Bunny Day card', 'Camo card', 'Card from', 'Card from Bank of Nook', 'Card from C.J.', 'Card from Flick', 'Card from Happy Home Academy', "Card from Jolly Redd's", 'Card from K.K.', 'Card from Nintendo', 'Card from Nook Mileage Program', 'Card from Your pals at Dodo Airlines', 'Carpet-of-leaves card', 'Cherry-blossoms card', 'Chocolate card', 'Chocolate-heart card', 'Common card', 'Cool-cool card', 'Dandelion card', 'Decorative card', 'Elegant-roses card', 'Fanciful card', 'Fantasy-stars card', "Father's Day card", 'Festive-tree card', 'Flower-bouquet card', 'Fluffy-clouds card', 'Full-bloom card', 'Gears card', 'Gem card', 'Gift card', 'Goldfish card', 'Graduation card', 'Graffiti card', 'Halloween card', 'Happy-clovers card', 'Turkey Day card', 'Hibiscus card', 'Holiday card', 'Lovely hearts card', "Mother's Day card", 'Mushroom card', 'Pumpkin card', 'Red-dragonflies card', 'Ribbon card', 'Shapes card', 'Shooting-stars card', 'Snowflake card', 'Snowperson card', 'So-many-hearts card', 'Star card', 'Stationery-goods card', 'Torn card', 'Town-view card', 'Velvety card', 'Warm-sweater card', 'Wedding card', 'Winter-camellia card', 'Zen card', 'acorns and pine cones', 'mushrooms', 'ornaments', 'Spring shopping', 'Summer shopping', 'Fall shopping', 'Winter shopping', 'Festive shopping', 'Birthday', 'Fishing Tourney', 'Bunny Day (ready days)', 'Bunny Day', 'May Day', 'International Museum Day', 'Wedding Season', 'Summer Solstice (northern hemisphere)', 'Winter Solstice (southern hemisphere)', 'Tanabata', 'Fireworks Show', 'Halloween (ready days)', 'Halloween', 'Turkey Day', 'Turkey Day (shopping days)', 'Toy Day (ready days phase 1)', 'Toy Day (ready days phase 2)', 'Toy Day', 'Toy Day (day after)', 'Winter Solstice (northern hemisphere)', 'Summer Solstice (southern hemisphere)', 'Shōgatsu (1)', 'Shōgatsu (2)', 'Shōgatsu (3)', "New Year's Day (Russia)", "New Year's Day (World)", "New Year's Day (Korea)", "New Year's Day (Asia)", 'Festivale (ready days)', 'Festivale', 'Setsubun (Able Sisters)', 'Big Game Celebration (1)', 'Big Game Celebration (2)', "Valentine's Day (Nook Shopping)", 'Super Mario Bros.', 'Shamrock Day (Able Sisters)', 'Prom (1)', 'Prom (2)', 'Prom (Able Sisters)', 'Nature Day (Nook Shopping)']
for dataSheet in data:
    for datum in data[dataSheet]:
        found = False
        if(datum.get("Source Notes") not in sourceNotes):
            sourceNotes.append(datum.get("Source Notes"))
            #print(datum.get("Source Notes"))
        if(datum.get("Source") not in sources):
            if(datum.get("Source")!=None and ";" in datum.get("Source")):
                for sourceSplit in datum.get("Source").split("; "):
                    if(sourceSplit not in sources):
                        sources.append(sourceSplit)
                        print(sourceSplit)
            else:
                sources.append(datum.get("Source"))
                print(datum.get("Source"))
        for translationSheet in translation:
            if(translationSheet in ignore):
                continue
            for translate in translation[translationSheet]:
                if(datum.get("Name")==None or translate.get("English")==None):
                    break
                elif(datum.get("Name")==translate.get("English")):
                    #datum.update(translate)                            
                    outputDictionary[translate.get("English")] = translate
                    found = True
        if(found == False):
            if(datum.get("Name") not in missingItems):
                #print(datum.get("Name"))
                missingItems.append(datum.get("Name"))

    length+=1
    #print(str(int(length/len(data)*100))+"%")

#print("issing Items")
#print(missingItems)
#print("Source Notes")
#print(sourceNotes)
#print("Sources")
#print(sources)

with open('Generated/translatedItems.json', 'w', encoding='utf8') as json_file:
    json.dump(outputDictionary, json_file, ensure_ascii=False,indent=2)


doneVariants = []
outputVariantsPatterns = {}
outputSpecialNPCs = {}
outputVillagerSayings = {}
length = 0
for translationSheet in translation:
    for translate in translation[translationSheet]:
        if("Variants" in translationSheet or
            "Patterns" in translationSheet or
            "HHA Themes" in translationSheet or
            "HHA Set" in translationSheet or
            "HHA Situation" in translationSheet):
            if(translate.get("English") in doneVariants):
                continue
            else:
                doneVariants.append(translate.get("English"))
                outputVariantsPatterns[translate.get("English")] = translate
        elif("Special NPCs" in translationSheet):
            outputSpecialNPCs[translate.get("English")] = translate
        elif("Villagers Catch Phrase" in translationSheet):
            outputVillagerSayings[translate.get("English")] = translate
    length+=1
    print(str(int(length/len(translation)*100))+"%")
    
with open('Generated/translatedVariants.json', 'w', encoding='utf8') as json_file:
    json.dump(outputVariantsPatterns, json_file, ensure_ascii=False,indent=2)
with open('Generated/translatedSpecialNPCs.json', 'w', encoding='utf8') as json_file:
    json.dump(outputSpecialNPCs, json_file, ensure_ascii=False,indent=2)
with open('Generated/translatedVillagerCatchPhrases.json', 'w', encoding='utf8') as json_file:
    json.dump(outputVillagerSayings, json_file, ensure_ascii=False,indent=2)

input("Done")
                        
                    
